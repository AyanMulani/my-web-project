<!doctype html><html><head><meta charset="utf-8"><title>HR Payroll Admin</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/static/style.css"></head><body>
<nav class="navbar navbar-dark" style="background:#2f5566"><div class="container-fluid"><a class="navbar-brand">Employee Payroll Management System</a>
<div class="d-flex"><a class="btn btn-outline-light btn-sm me-2" href="/export/employees">Export Employees</a><a class="btn btn-outline-light btn-sm" href="/logout">Logout</a></div></div></nav>
<div class="container my-4">
  <div class="row">
    <div class="col-lg-7">
      <div class="card mb-3"><div class="card-header">Employee Details</div>
        <div class="card-body">
          <form id="empForm" enctype="multipart/form-data" method="post" action="/employee/add">
            <div class="row g-2">
              <div class="col-md-5"><label>Employee Code</label><input name="emp_code" id="emp_code" class="form-control" required></div>
              <div class="col-md-3 align-self-end"><button id="search" type="button" class="btn btn-info">Search</button></div>
              <div class="col-md-4"><label>Department</label><select name="department_id" id="department_id" class="form-select"><option value="">--</option>{% for d in departments %}<option value='{{d.id}}'>{{d.name}}</option>{% endfor %}</select></div>
            </div>
            <div class="row g-2 mt-2"><div class="col-md-6"><label>First Name</label><input name="first_name" id="first_name" class="form-control"></div><div class="col-md-6"><label>Last Name</label><input name="last_name" id="last_name" class="form-control"></div></div>
            <div class="row g-2 mt-2"><div class="col-md-6"><label>Role</label><select name="role_id" id="role_id" class="form-select"><option value="">--</option>{% for r in roles %}<option value='{{r.id}}'>{{r.name}}</option>{% endfor %}</select></div><div class="col-md-6"><label>Contact</label><input name="contact" id="contact" class="form-control"></div></div>
            <div class="row g-2 mt-2"><div class="col-md-6"><label>Email</label><input name="email" id="email" class="form-control"></div><div class="col-md-6"><label>Basic Salary</label><input name="basic_salary" id="basic_salary" class="form-control"></div></div>
            <div class="row g-2 mt-2"><div class="col-8"><label>Address</label><textarea name="address" id="address" class="form-control" rows="2"></textarea></div>
            <div class="col-4"><label>Photo</label><input type="file" name="photo" class="form-control"></div></div>
            <div class="row mt-2"><div class="col-12"><button class="btn btn-success">Save Employee</button> <span id="save_status" class="text-success ms-2"></span></div></div>
          </form>
        </div></div>

      <div class="card shadow-sm">
        <div class="card-header">Employees</div>
        <div class="card-body p-0"><table class="table table-striped mb-0" id="emp_table"><thead class="table-light"><tr><th>Employee ID</th><th>First Name</th><th>Last Name</th><th>Department</th><th>Action</th></tr></thead>
          <tbody>{% for e in employees %}<tr data-emp-id='{{e.id}}'><td>{{ e.emp_code }}</td><td>{{ e.first_name }}</td><td>{{ e.last_name }}</td><td>{{ e.department.name if e.department else '' }}</td><td><button class='btn btn-sm btn-danger emp-delete' data-id='{{e.id}}'>Delete</button></td></tr>{% endfor %}</tbody></table></div></div>
    </div>

    <div class="col-lg-5">
      <div class="card mb-3"><div class="card-header">Employee Salary Details</div><div class="card-body">
        <form id="payForm" method="post" action="/payroll/create"><input type="hidden" name="emp_code" id="pay_emp_code">
        <div class="row g-2"><div class="col-md-5"><label>Month</label><input name="month" id="month" class="form-control"></div><div class="col-md-3"><label>Year</label><input name="year" id="year" class="form-control"></div><div class="col-md-4"><label>Salary</label><input name="net_salary" id="net_salary" class="form-control"></div></div>
        <div class="row g-2 mt-2"><div class="col-md-6"><label>Total Days</label><input name="total_days" id="total_days" class="form-control" value="30"></div><div class="col-md-6"><label>Absents</label><input name="absents" id="absents" class="form-control" value="0"></div></div>
        <div class="row g-2 mt-2"><div class="col-md-6"><label>Medical</label><input name="medical" id="medical" class="form-control" value="0"></div><div class="col-md-6"><label>PF</label><input name="pf" id="pf" class="form-control" value="0"></div></div>
        <div class="row g-2 mt-2"><div class="col-md-6"><label>Conveyance</label><input name="conveyance" id="conveyance" class="form-control" value="0"></div><div class="col-md-6"><label>Overtime</label><input name="overtime" id="overtime" class="form-control" value="0"></div></div>
        <div class="row g-2 mt-2"><div class="col-md-6"><label>Deducted</label><input name="deducted" id="deducted" class="form-control" value="0"></div><div class="col-md-6"><label>Added</label><input name="added" id="added" class="form-control" value="0"></div></div>
        <div class="row g-2 mt-2"><div class="col-md-8"><label>Net Salary</label><input name="net_salary" id="net_salary" class="form-control" readonly></div><div class="col-md-4 d-flex align-items-end"><button id="calc_btn" type="button" class="btn btn-primary me-2">Calculate</button><button class="btn btn-success" type="submit"> Save Payroll </button></div></div>
        </form></div></div>

      <div class="card mb-3"><div class="card-header">Salary Receipt</div><div class="card-body">
        <pre id="receipt_area"></pre>
        <div class="d-flex"><button id="print_receipt" class="btn btn-warning me-2">Print</button><a id="download_pdf" class="btn btn-outline-secondary" href="#">Download PDF</a></div>
      </div></div>

      <div class="card"><div class="card-body"><div class="calculator"><div class="row g-1 text-center">
      <div class="col-3"><button class="btn btn-primary calc-key">7</button></div><div class="col-3"><button class="btn btn-primary calc-key">8</button></div><div class="col-3"><button class="btn btn-primary calc-key">9</button></div><div class="col-3"><button class="btn btn-secondary calc-op">/</button></div>
      <div class="col-3"><button class="btn btn-primary calc-key">4</button></div><div class="col-3"><button class="btn btn-primary calc-key">5</button></div><div class="col-3"><button class="btn btn-primary calc-key">6</button></div><div class="col-3"><button class="btn btn-secondary calc-op">*</button></div>
      <div class="col-3"><button class="btn btn-primary calc-key">1</button></div><div class="col-3"><button class="btn btn-primary calc-key">2</button></div><div class="col-3"><button class="btn btn-primary calc-key">3</button></div><div class="col-3"><button class="btn btn-secondary calc-op">-</button></div>
      <div class="col-3"><button class="btn btn-primary calc-key">0</button></div><div class="col-3"><button id="calc-clear" class="btn btn-light">C</button></div><div class="col-3"><button id="calc-eq" class="btn btn-success">=</button></div><div class="col-3"><button class="btn btn-secondary calc-op">+</button></div>
      </div><input id="calc_screen" class="form-control mt-2" readonly></div></div></div>

    </div>
  </div>
  <hr>
  <h5>Payroll Records</h5>
  <table class="table table-bordered" id="pay_table"><thead class="table-light"><tr><th>ID</th><th>Employee</th><th>Month</th><th>Year</th><th>Net</th><th>Action</th><th>Action</th></tr></thead><tbody>{% for p in payrolls %}<tr><td>{{p.id}}</td><td>{{p.employee.emp_code}} - {{p.employee.first_name}}</td><td>{{p.month}}</td><td>{{p.year}}</td><td>{{'%.2f'|format(p.net_salary)}}</td><td><a class="btn btn-sm btn-outline-primary" href="/payroll/{{p.id}}/pdf">PDF</a></td></tr>{% endfor %}</tbody></table>
</div>
<script src="/static/main.js"></script>
</body></html>
